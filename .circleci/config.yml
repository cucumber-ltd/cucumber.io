aliases:
  - &install_now
    name: Install Now
    command: npm install now
  - &deploy
    name: Deploy using zeit.co's now
    command: |
      export NOW="./node_modules/.bin/now"
      export NOW_AUTH="--team cucumber --token $NOW_TOKEN"
      export NOW_PARAMS="--regions bru --no-verify"
      $NOW $NOW_AUTH $NOW_PARAMS && $NOW alias

defaults: &defaults
  docker:
    - image: circleci/node

version: 2
jobs:
  build:
    <<: *defaults
    steps:
      - checkout
      - run: *install_now
      - run: *deploy